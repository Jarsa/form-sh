<?xml version="1.0"?>
<odoo>
    <template id="report_purchase_order_external_for_form" inherit_id="purchase.report_purchaseorder_document">
        <xpath expr="//t[1]/div[1]/h2[1]" position="replace"/>
        <xpath expr="//t[1]/div[1]/h2[2]" position="replace"/>
        <xpath expr="//t[@t-set='address']" position="replace"/>
        <xpath expr="//t[1]/t[3]/t[1]" position="replace"/>
        <xpath expr="//div[hasclass('page')]" position="replace">
            <div class="page">
                <div class="row">
                    <div class="col-6">
                        <h6><strong t-field="o.name"/></h6>
                        <div style="border: none; font-size: 10px;">
                            <strong>Order to:</strong><br/>
                            <span t-field="o.partner_id"/><br/>
                            <span t-esc="o.partner_id.street_name"/>&amp;nbsp;
                            <span t-field="o.partner_id.street_number"/><br/>
                            <span t-field="o.partner_id.street2"/>
                            <span t-if="o.partner_id.l10n_mx_edi_colony" t-field="o.partner_id.l10n_mx_edi_colony"/>
                            <span t-if="o.partner_id.l10n_mx_edi_locality" t-field="o.partner_id.l10n_mx_edi_locality"><br/></span>
                            <span t-if="o.partner_id.zip">ZIP&amp;nbsp;</span><span t-esc="o.partner_id.zip"/><br/>
                            <span t-field="o.partner_id.city"/>
                            <span t-field="o.partner_id.state_id.name"/>&amp;nbsp;
                            <span t-field="o.partner_id.country_id"/><br/>
                            <span t-if="o.partner_id.vat">VAT&amp;nbsp;</span><span t-esc="o.partner_id.vat"/>
                        </div>
                    </div>
                    <div class="col-6" style="border: none; font-size: 10px;">
                        <br/><strong>Deliver to</strong><br/>
                        <span t-field="o.picking_type_id.warehouse_id.name" class="m-0"/><br/>
                        <span t-field="o.picking_type_id.warehouse_id.partner_id"/><br/>
                        <span t-esc="o.picking_type_id.warehouse_id.partner_id.street_name"/>&amp;nbsp;
                        <span t-field="o.picking_type_id.warehouse_id.partner_id.street_number"/><br/>
                        <span t-field="o.picking_type_id.warehouse_id.partner_id.street2"/>
                        <span t-if="o.picking_type_id.warehouse_id.partner_id.l10n_mx_edi_colony" t-field="o.partner_id.l10n_mx_edi_colony"/>
                        <span t-if="o.picking_type_id.warehouse_id.partner_id.l10n_mx_edi_locality" t-field="o.partner_id.l10n_mx_edi_locality"><br/></span>
                        <span t-if="o.picking_type_id.warehouse_id.partner_id.zip">ZIP&amp;nbsp;</span><span t-esc="o.picking_type_id.warehouse_id.partner_id.zip"/><br/>
                        <span t-field="o.picking_type_id.warehouse_id.partner_id.city"/>
                        <span t-field="o.picking_type_id.warehouse_id.partner_id.state_id.name"/>&amp;nbsp;
                        <span t-field="o.picking_type_id.warehouse_id.partner_id.country_id"/><br/>
                        <span t-if="o.picking_type_id.warehouse_id.partner_id.vat">VAT&amp;nbsp;</span><span t-esc="o.picking_type_id.warehouse_id.partner_id.vat"/><br/><br/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12" style="font-size: 10px;">
                        <div id="informations" class="row mt32 mb32">
                            <table class="col-12">
                                <thead>
                                    <tr style="border: 1px solid black; background-color: #F36B21; color: white;">
                                        <th t-if="o.date_order"><strong>Order Date</strong></th>
                                        <th t-if="o.payment_term_id"><strong>Conditions</strong></th>
                                        <th t-if="o.currency_id"><strong>Currency</strong></th>
                                        <th t-if="o.user_id"><strong>Purchaser</strong></th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr style="border: 1px solid black;">
                                        <td t-if="o.date_order">
                                            <p t-field="o.date_order" t-options="{'widget': 'date'}"/>
                                        </td>
                                        <td t-if="o.payment_term_id">
                                            <p t-field="o.payment_term_id"/>
                                        </td>
                                        <td t-if="o.currency_id">
                                            <p t-field="o.currency_id"/>
                                        </td>
                                        <td t-if="o.user_id">
                                            <p t-field="o.user_id"/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <div class="col-12" style="font-size: 10px;">
                        <div id="line" class="row mt32 mb32">
                            <table class="col-12">
                                <thead style="border: 1px solid black; background-color: #F36B21; color: white;">
                                    <tr class="text-center">
                                        <th><strong>Code</strong></th>
                                        <th><strong>Qty</strong></th>
                                        <th><strong>Unit</strong></th>
                                        <th><strong>Description</strong></th>
                                        <th><strong>Unit Price</strong></th>
                                        <th><strong>Taxes</strong></th>
                                        <th><strong>Date Planned</strong></th>
                                        <th><strong>Amount</strong></th>
                                    </tr>
                                </thead>
                                <tbody style="border: 1px solid black; background-color: none;">
                                    <tr t-foreach="o.order_line" t-as="line" style="border: 1px solid black;">
                                        <td>
                                            <span t-esc="line.product_id.default_code"/>
                                        </td>                        
                                        <td class="text-center">
                                            <span t-field="line.product_qty"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-field="line.product_uom.name" groups="uom.group_uom"/>
                                        </td>
                                        <td>
                                            <span t-field="line.name"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-field="line.price_unit"/>
                                        </td>
                                        <td class="text-center">
                                            <span t-esc="', '.join(map(lambda x: x.description, line.taxes_id))"/>
                                        </td>                                        
                                        <td class="text-center">
                                            <span t-esc="line.date_planned" t-options="{'widget': 'date'}"/>
                                        </td>
                                        <td class="text-right">
                                            <span t-field="line.price_subtotal"
                                                t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <div class="col-7 pull-left">
                        <strong>Obervations: </strong>
                        <p t-field="o.notes"/><br/><br/>
                        <p t-esc="o.company_id.currency_id.amount_to_text(o.amount_total)"/>
                    </div>
                    <div class="col-5 pull-right" style="padding-right: 0px;">
                        <table class="table table-sm">
                            <tr class="border-black">
                                <td><strong>Subtotal</strong></td>
                                <td class="text-right">
                                    <span t-field="o.amount_untaxed"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>
                            <tr>
                                <td>Taxes</td>
                                <td class="text-right">
                                    <span t-field="o.amount_tax"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>
                            <tr class="border-black">
                                <td style="background-color: #F36B21; color: white;"><strong>Total</strong></td>
                                <td style="background-color: #F36B21; color: white;" class="text-right">
                                    <span t-field="o.amount_total"
                                        t-options='{"widget": "monetary", "display_currency": o.currency_id}'/>
                                </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <p>Please confirm delivery date in a term not major to 24 hours, email way.
                Deliver with purchase order and invoice.</p>
                <p>Reception schedule Mon-Fri 8:30 to 13:30 and 14:30 to 16:30, Saturday 8:30 A.M. to 12:30 P.M.</p>
            </div>
        </xpath>
    </template>
</odoo>
