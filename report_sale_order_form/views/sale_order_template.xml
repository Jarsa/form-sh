<?xml version="1.0"?>
<odoo>
    <template id="report_sale_order_external_for_form" inherit_id="sale.report_saleorder_document">
        <xpath expr="//t[1]/t[2]" position="replace">
            <t>
                <div class="row">
                    <div class="col">
                        <h2 style="text-transform: uppercase;">
                            <t t-if="not doc.master_sale_order">Remission</t>
                            <t t-if="doc.master_sale_order">Order</t>
                        </h2>
                        <p>
                            <strong>
                                <t t-if="not doc.master_sale_order">Remission code:</t>
                                <t t-if="doc.master_sale_order">Order code:</t>
                            </strong><span t-esc="doc.name"/>
                        </p>
                    </div>
                </div>
            </t>
        </xpath>
        <xpath expr="//t[1]/t[3]" position="replace">
            <t></t>
        </xpath>
        <xpath expr="//div[@class='page']" position="replace">
            <div class="page">
                <div class="row">
                    <div class="col-6">
                        <span><strong>Sold to:</strong></span><br/>
                        <div t-if="doc.partner_id" name="partner_header">
                            <span t-field="doc.partner_id"/><br/>
                            <t t-set="street_name" t-value="doc.partner_id.street_name or ''"/>
                            <span t-esc="street_name + ' '"/>
                            <span t-field="doc.partner_id.street_number"/><br/>
                            <span t-field="doc.partner_id.street2"/>
                            <span t-if="doc.partner_id.l10n_mx_edi_colony" t-field="doc.partner_id.l10n_mx_edi_colony"/>
                            <span t-if="doc.partner_id.l10n_mx_edi_locality" t-field="doc.partner_id.l10n_mx_edi_locality"><br/></span>
                            
                            <t t-set="zip_code" t-value="doc.partner_id.zip or ''"/>
                            <span t-esc="'C.P. ' + zip_code"/><br/>
                            <span t-field="doc.partner_id.city"/>
                            <span t-field="doc.partner_id.state_id.name"/><br/>
                            <span t-field="doc.partner_id.country_id"/>
                            <p t-if="doc.sudo().partner_id.vat"><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/>: <span t-field="doc.sudo().partner_id.vat"/></p>
                        </div>
                    </div>
                    <div class="col-6">
                        <t t-if="doc.partner_shipping_id">
                            <span><strong>Costumer address:</strong></span><br/>
                            <div t-if="doc.partner_shipping_id" name="partner_header">
                                <span t-field="doc.partner_shipping_id"/><br/>
                                <t t-set="street_name2" t-value="doc.partner_shipping_id.street_name or ''"/>
                                <span t-esc="street_name2 + ' '"/>
                                <span t-field="doc.partner_shipping_id.street_number"/><br/>
                                <span t-field="doc.partner_shipping_id.street2"/>
                                <span t-if="doc.partner_shipping_id.l10n_mx_edi_colony" t-field="doc.partner_shipping_id.l10n_mx_edi_colony"/>
                                <span t-if="doc.partner_shipping_id.l10n_mx_edi_locality" t-field="doc.partner_shipping_id.l10n_mx_edi_locality"><br/></span>
                                <t t-set="zip_code2" t-value="doc.partner_shipping_id.zip or ''"/>
                                <span t-esc="'C.P. ' + zip_code2"/><br/>
                                <span t-field="doc.partner_shipping_id.city"/>
                                <span t-field="doc.partner_shipping_id.state_id.name"/><br/>
                                <span t-field="doc.partner_shipping_id.country_id"/>
                                <p t-if="doc.sudo().partner_shipping_id.vat"><t t-esc="doc.company_id.country_id.vat_label or 'Tax ID'"/>: <span t-field="doc.sudo().partner_shipping_id.vat"/></p>
                            </div>
                        </t>
                    </div>
                </div><br/>
                <div class="row">
                    <div class="col">
                        <table class="table table-sm table-bordered">
                            <thead>
                                <tr style="text-transform: uppercase;background-color: #F36B21; color: white;">
                                    <th><strong>Partner code</strong></th>
                                    <th><strong>Order partner</strong></th>
                                    <th>
                                        <strong>
                                            <t t-if="not doc.master_sale_order">Remission Date</t>
                                            <t t-if="doc.master_sale_order">Order Date</t>
                                        </strong>
                                    </th>
                                    <th><strong>Currency</strong></th>
                                </tr>
                            </thead>
                            <tr style="background-color: #FFFFFF; font-style: normal;">
                                <th><span t-esc="doc.partner_id.ref"/></th>
                                <th><span t-field="doc.client_order_ref"/></th>
                                <th><span t-field="doc.confirmation_date"/></th>
                                <th><span t-esc="doc.pricelist_id.currency_id.name"/></th>
                            </tr>
                        </table>
                    </div>
                </div>
                <br/>
                <div class="row">
                    <div class="col-12">
                        <table class="table table-sm table-bordered">
                            <thead>
                                <tr style="text-transform: uppercase;background-color: #F36B21; color: white;">
                                    <th class="text-right">Quantity</th>
                                    <th class="text-left">Unit</th>
                                    <th class="text-left">Key</th>
                                    <th class="text-left">Description</th>
                                    <th class="text-right">Unit Price</th>
                                    <th class="text-right">Import</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr t-foreach="doc.order_line" t-as="line">
                                    <t t-if="not line.display_type">
                                        <th style="background-color: #FFFFFF; font-style: normal;" class="text-right"><span t-esc="int(line.product_uom_qty)"/></th>
                                        <th style="background-color: #FFFFFF; font-style: normal;"><span t-field="line.product_uom"/></th>
                                        <th style="background-color: #FFFFFF; font-style: normal;"><span t-field="line.product_id.default_code"/></th>
                                        <th style="background-color: #FFFFFF; font-style: normal;"><span t-field="line.name"/></th>
                                        <th style="background-color: #FFFFFF; font-style: normal;" class="text-right">
                                            <span t-esc="'%.2f' % (float(line.price_unit))"/>
                                        </th>
                                        <th style="background-color: #FFFFFF; font-style: normal;" class="text-right o_price_total">
                                            <span t-esc="'%.2f' % (float(line.price_unit * line.product_uom_qty))"/>
                                        </th>
                                    </t>
                                    <t t-if="line.display_type == 'line_section'">
                                        <th>
                                            <span t-field="line.name"/>
                                        </th>
                                        <t t-set="current_section" t-value="line"/>
                                        <t t-set="current_subtotal" t-value="0"/>
                                    </t>
                                    <t t-if="line.display_type == 'line_note'">
                                        <th>
                                            <span t-field="line.name"/>
                                        </th>
                                    </t>
                                </tr>
                            </tbody>
                        </table>
                        <div id="total" class="row justify-content-end">
                            <div class="col-4">
                                <table class="table table-sm">
                                    <tr class="border-black">
                                        <td><strong>Subtotal</strong></td>
                                        <td class="text-right">
                                            <span t-esc="doc.amount_untaxed" t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                        </td>
                                    </tr>
                                    <t t-foreach="doc.get_tax()" t-as="taxes">
                                        <tr class="border-black">
                                            <td>
                                                <strong class="text-right" t-esc="taxes"/>
                                            </td>
                                            <td class="text-right o_price_total">
                                                <span t-esc="taxes_value" t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                            </td>
                                        </tr>
                                    </t>
                                    <tr class="border-black">
                                        <td style="background-color: #F36B21; color: white;"><strong>Total</strong></td>
                                        <td style="background-color: #F36B21; color: white;" class="text-right">
                                            <span t-esc="doc.amount_total" t-options='{"widget": "monetary", "display_currency": doc.pricelist_id.currency_id}'/>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <strong>Observations:</strong>
                        <p t-field="doc.note"/>
                        <br/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <p>________________________________</p>
                        <p>Deliver</p>
                    </div>
                    <div class="col-6">                    
                        <p>________________________________</p>
                        <p>Receipt</p>
                    </div>
                </div>
                <div name="payment_term"/>
                <p id="fiscal_position_remark" t-if="doc.fiscal_position_id and doc.fiscal_position_id.note">
                    <strong>Fiscal Position Remark:</strong>
                    <span t-field="doc.fiscal_position_id.note"/>
                </p>
            </div>
        </xpath>
    </template>
</odoo>
